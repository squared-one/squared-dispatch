#!/bin/bash

service cups start

lpadmin -p Zebra_Technologies_ZTC_ZP_505 \
  -v socket://$FEDEX_PRINTER_IP \
  -E \
  -o Resolution=203dpi

inotifywait -m /target -e moved_to |
  while read path action file; do
    echo "$file appeared in $path via $action"

    if [[ $file =~ .+_fedex\.zplii$ ]];
    then
      lp -d Zebra_Technologies_ZTC_ZP_505 /target/$file
      sleep 1
      rm /target/$file
    fi
  done
